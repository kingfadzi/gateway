version: 1
updated_at: 2025-08-29

fields:
  # ---- Confidentiality
  - key: confidentiality_level
    label: Confidentiality Level
    derived_from: confidentiality_rating
    rule:
      A: { value: restricted,   label: "Restricted",   ttl: 90d }
      B: { value: confidential, label: "Confidential", ttl: 90d }
      C: { value: internal,     label: "Internal",     ttl: 180d }
      D: { value: public,       label: "Public",       ttl: 365d }

  - key: data_residency_control
    label: Data Residency Control
    derived_from: confidentiality_rating
    rule:
      A: { value: required_in_region,      label: "Required in-region",      ttl: 90d }
      B: { value: preferred_in_region,     label: "Preferred in-region",     ttl: 90d }
      C: { value: permitted_cross_region,  label: "Permitted cross-region",  ttl: 180d }
      D: { value: unrestricted,            label: "Unrestricted",            ttl: 365d }

  - key: de_identification
    label: De-Identification
    derived_from: confidentiality_rating
    rule:
      A: { value: mandatory_strong, label: "Mandatory (strong)", ttl: 90d }
      B: { value: required,         label: "Required",           ttl: 90d }
      C: { value: recommended,      label: "Recommended",        ttl: 180d }
      D: { value: optional,         label: "Optional",           ttl: 365d }

  # ---- Security
  - key: encryption_at_rest
    label: Encryption at Rest
    derived_from: security_rating
    rule:
      A1: { value: required, ttl: 90d }
      A2: { value: required, ttl: 90d }
      B:  { value: required, ttl: 180d }
      C:  { value: required, ttl: 365d }
      D:  { value: optional, ttl: 365d }

  - key: encryption_in_transit
    label: Encryption in Transit
    derived_from: security_rating
    rule:
      A1: { value: required, ttl: 90d }
      A2: { value: required, ttl: 90d }
      B:  { value: required, ttl: 180d }
      C:  { value: recommended, ttl: 365d }
      D:  { value: recommended, ttl: 365d }

  - key: security_testing
    label: Security Testing
    derived_from: security_rating
    rule:
      A1: { value: external_pentest_annual+continuous_scans, ttl: 365d }
      A2: { value: internal_pentest_annual+continuous_scans, ttl: 365d }
      B:  { value: sast+dast_quarterly_scan, ttl: 90d }
      C:  { value: sast_on_release, ttl: 180d }
      D:  { value: sast_optional, ttl: 365d }

  - key: secrets_management
    label: Secrets Management
    derived_from: security_rating
    rule:
      A1: { value: centralized_required, ttl: 90d }
      A2: { value: centralized_required, ttl: 90d }
      B:  { value: centralized_recommended, ttl: 180d }
      C:  { value: centralized_recommended, ttl: 365d }
      D:  { value: minimal_ok, ttl: 365d }

  - key: key_rotation_max
    label: Key Rotation Max
    derived_from: security_rating
    rule:
      A1: { value: 90d,  ttl: 90d }
      A2: { value: 180d, ttl: 180d }
      B:  { value: 365d, ttl: 365d }
      C:  { value: 365d, ttl: 365d }
      D:  { value: n/a,  ttl: 0d }

  # ---- Integrity
  - key: data_validation
    label: Data Validation
    derived_from: integrity_rating
    rule:
      A: { value: dual_control,        ttl: 90d }
      B: { value: strong_validation,   ttl: 90d }
      C: { value: standard_validation, ttl: 180d }
      D: { value: minimal_validation,  ttl: 365d }

  - key: reconciliation_frequency
    label: Reconciliation Frequency
    derived_from: integrity_rating
    rule:
      A: { value: daily,   ttl: 90d }
      B: { value: weekly,  ttl: 30d }
      C: { value: per_release, ttl: 180d }
      D: { value: ad_hoc, ttl: 180d }

  - key: audit_logging
    label: Audit Logging
    derived_from: integrity_rating
    rule:
      A: { value: full_with_daily_review, ttl: 90d }
      B: { value: full_with_periodic_review, ttl: 90d }
      C: { value: logging_enabled+sampled_review, ttl: 180d }
      D: { value: basic_logging, ttl: 365d }

  - key: change_control
    label: Change Control
    derived_from: integrity_rating
    rule:
      A: { value: independent_review+regression_suite, ttl: 90d }
      B: { value: peer_review+regression_suite, ttl: 90d }
      C: { value: peer_review+unit_tests, ttl: 90d }
      D: { value: optional_peer_review, ttl: 180d }

  - key: immutability_required
    label: Immutability Required
    derived_from: integrity_rating
    rule:
      A: { value: yes, ttl: 90d }
      B: { value: yes, ttl: 90d }
      C: { value: no,  ttl: 180d }
      D: { value: no,  ttl: 365d }

  # ---- Availability
  - key: rto_hours
    label: RTO (hours)
    derived_from: availability_rating
    rule:
      A: { value: 1, ttl: 90d }
      B: { value: 4, ttl: 90d }
      C: { value: 24, ttl: 180d }
      D: { value: best_effort, ttl: 365d }

  - key: rpo_minutes
    label: RPO (minutes)
    derived_from: availability_rating
    rule:
      A: { value: 5, ttl: 90d }
      B: { value: 60, ttl: 90d }
      C: { value: 240, ttl: 180d }
      D: { value: best_effort, ttl: 365d }

  - key: ha_topology
    label: HA Topology
    derived_from: availability_rating
    rule:
      A: { value: active_active,  ttl: 90d }
      B: { value: active_passive, ttl: 90d }
      C: { value: backup_restore, ttl: 180d }
      D: { value: none, ttl: 365d }

  - key: monitoring_slos
    label: Monitoring SLOs
    derived_from: availability_rating
    rule:
      A: { value: "99.9+_with_alerting", ttl: 90d }
      B: { value: "99.5_with_alerting",  ttl: 90d }
      C: { value: "99.0", ttl: 180d }
      D: { value: none, ttl: 365d }

  - key: oncall_coverage
    label: On-call Coverage
    derived_from: availability_rating
    rule:
      A: { value: "24x7", ttl: 90d }
      B: { value: "16x5", ttl: 90d }
      C: { value: "business_hours", ttl: 90d }
      D: { value: none, ttl: 365d }

  # ---- Resilience
  - key: dr_test_frequency
    label: DR Test Frequency
    derived_from: resilience_rating
    rule:
      "0": { value: semi_annual_live, ttl: 180d }
      "1": { value: annual_live,      ttl: 365d }
      "2": { value: annual_tabletop,  ttl: 180d }
      "3": { value: ad_hoc_tabletop,  ttl: 365d }
      "4": { value: none,             ttl: 0d }

  - key: backup_policy
    label: Backup Policy
    derived_from: resilience_rating
    rule:
      "0": { value: encrypted_geo_redundant+tested_restores, ttl: 90d }
      "1": { value: encrypted+tested_restores, ttl: 90d }
      "2": { value: standard_backups+periodic_restore_test, ttl: 180d }
      "3": { value: standard_backups, ttl: 365d }
      "4": { value: optional, ttl: 0d }

  - key: failover_automation
    label: Failover Automation
    derived_from: resilience_rating
    rule:
      "0": { value: automatic, ttl: 90d }
      "1": { value: semi_automatic, ttl: 90d }
      "2": { value: manual, ttl: 180d }
      "3": { value: manual, ttl: 365d }
      "4": { value: best_effort, ttl: 0d }

  - key: runbook_maturity
    label: Runbook Maturity
    derived_from: resilience_rating
    rule:
      "0": { value: certified, ttl: 90d }
      "1": { value: approved,  ttl: 90d }
      "2": { value: draft,     ttl: 30d }
      "3": { value: draft,     ttl: 30d }
      "4": { value: none,      ttl: 0d }

  - key: chaos_testing
    label: Chaos Testing
    derived_from: resilience_rating
    rule:
      "0": { value: required,    ttl: 90d }
      "1": { value: recommended, ttl: 180d }
      "2": { value: optional,    ttl: 365d }
      "3": { value: none,        ttl: 0d }
      "4": { value: none,        ttl: 0d }

  # ---- App Criticality
  - key: materiality
    label: Materiality
    derived_from: app_criticality
    rule:
      A: { value: crown_jewel, ttl: 365d }
      B: { value: high,        ttl: 365d }
      C: { value: medium,      ttl: 365d }
      D: { value: low,         ttl: 365d }

  - key: review_depth
    label: Review Depth
    derived_from: app_criticality
    rule:
      A: { value: full_review,    ttl: 365d }
      B: { value: scoped_review,  ttl: 365d }
      C: { value: express_review, ttl: 365d }
      D: { value: self_attested,  ttl: 365d }

  # ---- Governance Artifacts
  - key: product_vision
    label: Product Vision
    derived_from: artifact
    rule:
      required: { value: required, ttl: 90d }

  - key: product_roadmap
    label: Product Roadmap
    derived_from: artifact
    rule:
      required: { value: required, ttl: 90d }

  - key: architecture_vision
    label: Architecture Vision
    derived_from: artifact
    rule:
      required: { value: required, ttl: 90d }

  - key: service_vision
    label: Service Vision
    derived_from: artifact
    rule:
      required: { value: required, ttl: 90d }

  - key: security_vision
    label: Security Vision
    derived_from: artifact
    rule:
      required: { value: required, ttl: 90d }

  - key: test_vision
    label: Test Vision
    derived_from: artifact
    rule:
      required: { value: required, ttl: 90d }

  # =========================
  # NEW: Identity & Access Mgmt
  # =========================
  - key: mfa_enforcement
    label: Multi-Factor Authentication
    derived_from: security_rating
    rule:
      A1: { value: required,   ttl: 90d }
      A2: { value: required,   ttl: 90d }
      B:  { value: recommended, ttl: 180d }
      C:  { value: optional,   ttl: 365d }
      D:  { value: n/a,        ttl: 0d }

  - key: access_review
    label: Access Review Cadence
    derived_from: app_criticality
    rule:
      A: { value: quarterly,   ttl: 90d }
      B: { value: semi_annual, ttl: 180d }
      C: { value: annual,      ttl: 365d }
      D: { value: n/a,         ttl: 0d }

  - key: privileged_access_mgmt
    label: Privileged Access Management
    derived_from: security_rating
    rule:
      A1: { value: centralized_required, ttl: 90d }
      A2: { value: centralized_required, ttl: 90d }
      B:  { value: centralized_recommended, ttl: 180d }
      C:  { value: manual_ok, ttl: 365d }
      D:  { value: n/a, ttl: 0d }

  # =========================
  # NEW: Vulnerability & Patch Management
  # =========================
  - key: patching_sla
    label: Patch Remediation SLA
    derived_from: security_rating
    rule:
      A1: { value: critical_30d, ttl: 90d }
      A2: { value: critical_30d, ttl: 90d }
      B:  { value: critical_60d, ttl: 180d }
      C:  { value: best_effort,  ttl: 365d }
      D:  { value: n/a,          ttl: 0d }

  - key: dependency_management
    label: Dependency / SBOM Management
    derived_from: security_rating
    rule:
      A1: { value: sbom_required, ttl: 90d }
      A2: { value: sbom_required, ttl: 180d }
      B:  { value: sbom_recommended, ttl: 365d }
      C:  { value: optional, ttl: 365d }
      D:  { value: n/a, ttl: 0d }

  # =========================
  # NEW: Incident Response
  # =========================
  - key: ir_plan
    label: Incident Response Plan
    derived_from: app_criticality
    rule:
      A: { value: tested_quarterly, ttl: 90d }
      B: { value: tested_annually,  ttl: 365d }
      C: { value: documented,       ttl: 365d }
      D: { value: n/a,              ttl: 0d }

  - key: ir_exercise
    label: Incident Response Exercise
    derived_from: app_criticality
    rule:
      A: { value: annual_live, ttl: 365d }
      B: { value: tabletop,    ttl: 365d }
      C: { value: optional,    ttl: 365d }
      D: { value: n/a,         ttl: 0d }

  # =========================
  # NEW: Third-Party / TPSP Risk (PCI-relevant)
  # =========================
  - key: tpsp_attestation
    label: Third-Party Service Provider Attestation
    derived_from: confidentiality_rating
    rule:
      A: { value: required, ttl: 365d }
      B: { value: required, ttl: 365d }
      C: { value: recommended, ttl: 365d }
      D: { value: n/a, ttl: 0d }

  # =========================
  # NEW: Data Lifecycle & Privacy
  # =========================
  - key: data_retention_policy
    label: Data Retention Policy
    derived_from: confidentiality_rating
    rule:
      A: { value: defined+enforced, ttl: 365d }
      B: { value: defined,          ttl: 365d }
      C: { value: recommended,      ttl: 365d }
      D: { value: n/a,              ttl: 0d }

  - key: data_deletion_evidence
    label: Secure Data Deletion Evidence
    derived_from: confidentiality_rating
    rule:
      A: { value: required, ttl: 365d }
      B: { value: required, ttl: 365d }
      C: { value: optional, ttl: 365d }
      D: { value: n/a,      ttl: 0d }

  # =========================
  # NEW: Network Security (internet-grade for A1/A2)
  # =========================
  - key: network_segmentation
    label: Network Segmentation Evidence
    derived_from: app_criticality
    rule:
      A: { value: pci_cde_required, ttl: 365d }
      B: { value: segmentation_required, ttl: 365d }
      C: { value: recommended, ttl: 365d }
      D: { value: n/a, ttl: 0d }

  - key: waf_protection
    label: Web Application Firewall Evidence
    derived_from: app_criticality
    rule:
      A: { value: required, ttl: 90d }
      B: { value: required, ttl: 90d }
      C: { value: recommended, ttl: 180d }
      D: { value: n/a, ttl: 0d }

  # =========================
  # NEW: Logging & Monitoring (extended)
  # =========================
  - key: log_retention
    label: Log Retention Period
    derived_from: integrity_rating
    rule:
      A: { value: ">=1y", ttl: 365d }
      B: { value: ">=6m", ttl: 365d }
      C: { value: ">=90d", ttl: 365d }
      D: { value: n/a, ttl: 0d }

  - key: siem_integration
    label: SIEM / Central Log Integration
    derived_from: app_criticality
    rule:
      A: { value: required, ttl: 365d }
      B: { value: required, ttl: 365d }
      C: { value: recommended, ttl: 365d }
      D: { value: n/a, ttl: 0d }